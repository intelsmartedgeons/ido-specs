<!DOCTYPE html>
<html lang="en">

    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Converged Edge Experience Kits | Docs</title>
<meta name="generator" content="Jekyll v3.4.1" />
<meta property="og:title" content="Converged Edge Experience Kits" />
<meta property="og:locale" content="en" />
<meta name="description" content="SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation Converged Edge Experience Kits Purpose Converged Edge Experience Kit explained The inventory file Sample Deployment Definitions Single Cluster Deployment Single-node Cluster Deployment Multi-cluster deployment Deployment customization Customizing kernel, grub parameters, and tuned profile &amp; variables per host IP address range allocation for various CNIs and interfaces Default values Use different realtime kernel (3.10.0-1062) Use different non-rt kernel (3.10.0-1062) Use tuned 2.9 Default kernel and configure tuned Change amount of HugePages Change size of HugePages Change amount and size of HugePages Remove input output memory management unit (IOMMU) from grub params Add custom GRUB parameter Configure OVS-DPDK in kube-ovn Adding new CNI plugins for Kubernetes (Network Edge)" />
<meta property="og:description" content="SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation Converged Edge Experience Kits Purpose Converged Edge Experience Kit explained The inventory file Sample Deployment Definitions Single Cluster Deployment Single-node Cluster Deployment Multi-cluster deployment Deployment customization Customizing kernel, grub parameters, and tuned profile &amp; variables per host IP address range allocation for various CNIs and interfaces Default values Use different realtime kernel (3.10.0-1062) Use different non-rt kernel (3.10.0-1062) Use tuned 2.9 Default kernel and configure tuned Change amount of HugePages Change size of HugePages Change amount and size of HugePages Remove input output memory management unit (IOMMU) from grub params Add custom GRUB parameter Configure OVS-DPDK in kube-ovn Adding new CNI plugins for Kubernetes (Network Edge)" />
<link rel="canonical" href="http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/converged-edge-experience-kits/" />
<meta property="og:url" content="http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/converged-edge-experience-kits/" />
<meta property="og:site_name" content="Docs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-29T23:11:19+05:30" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/converged-edge-experience-kits/"},"datePublished":"2021-09-29T23:11:19+05:30","headline":"Converged Edge Experience Kits","url":"http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/converged-edge-experience-kits/","description":"SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation Converged Edge Experience Kits Purpose Converged Edge Experience Kit explained The inventory file Sample Deployment Definitions Single Cluster Deployment Single-node Cluster Deployment Multi-cluster deployment Deployment customization Customizing kernel, grub parameters, and tuned profile &amp; variables per host IP address range allocation for various CNIs and interfaces Default values Use different realtime kernel (3.10.0-1062) Use different non-rt kernel (3.10.0-1062) Use tuned 2.9 Default kernel and configure tuned Change amount of HugePages Change size of HugePages Change amount and size of HugePages Remove input output memory management unit (IOMMU) from grub params Add custom GRUB parameter Configure OVS-DPDK in kube-ovn Adding new CNI plugins for Kubernetes (Network Edge)","dateModified":"2021-09-29T23:11:19+05:30","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta property="og:image" content="http://localhost:4000/intel-smart-edge-open/ido-specs/uploads/"/>
  <!-- <link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/main.css"> -->
  <link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/custom.css">
  <link rel="shortcut icon" type="image/png" href="/intel-smart-edge-open/ido-specs/uploads/favicon.png" >
  <link rel="alternate" type="application/rss+xml" title="Docs" href="/intel-smart-edge-open/ido-specs/feed.xml">
  <script type="text/javascript" src="/intel-smart-edge-open/ido-specs/assets/js/jquery.js"></script>
  <script src="/intel-smart-edge-open/ido-specs/assets/js/main.js"></script>
  
    <script>
function searchResults(form) {

    var currentItem = null;
    var search = document.getElementById(form);
    var results = document.getElementById(form + "-results");
    var toggle = document.getElementById(form + "-toggle");

    function removeActive() {
        for (i = 0; i < results.children.length; i++) {
            results.children[i].classList.remove("uk-background-muted");
        }
    }

    // Detect all clicks on the document
    document.addEventListener("click", function(event) {

        var isClickSearch = false;
        var isClickResults = false;
        var isClickSearchToggle = false;

        if (search !== null) {
            isClickSearch = search.contains(event.target);
        }

        if (results !== null) {
            isClickResults = results.contains(event.target);
        }

        if (toggle !== null) {
            isClickSearchToggle = toggle.contains(event.target);
        }

        if (isClickSearch || isClickSearchToggle) {
            results.style.display = "block";
        }        

        if (!isClickResults && !isClickSearch && !isClickSearchToggle) {
            results.style.display = "none";
        }        
        
    });    

    results.addEventListener("mouseover", function(event) {

        removeActive();
        event.target.parentElement.classList.add("uk-background-muted");
        currentItem = null;

    });

    results.addEventListener("mouseout", function(event) {
        event.target.parentElement.classList.remove("uk-background-muted");
    });


    search.addEventListener("keyup", function(event) {

        var resultItems = results.children;
        var resultCount = results.children.length;
                                
        if (event.keyCode === 40) {

            if (currentItem < (resultCount - 1)) {
                if (currentItem === null) {
                    currentItem = 0;
                } else {
                    removeActive();
                    currentItem++;
                }
                removeActive();
                resultItems[currentItem].classList.add("uk-background-muted");
            }
            
        } else if (event.keyCode === 38) {

            if (currentItem > 0) {
                if (currentItem === null) {
                    currentItem = 0;
                } else {
                    removeActive();
                    currentItem--;
                }
                removeActive();
                resultItems[currentItem].classList.add("uk-background-muted");
            }

        } else if (event.keyCode === 13) {

            resultItems[currentItem].children[0].click();

        }

    });

}
</script>
  
  
  
</head>

    <body>

    
        <div data-uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 200">
    <nav class="uk-navbar-container">
        <div class="uk-container">
            <div data-uk-navbar>
                <div class="uk-navbar-left">
                    <!-- <a class="uk-navbar-item uk-logo uk-visible@m" href="/intel-smart-edge-open/ido-specs/">Docs</a> -->
                    <a class="uk-navbar-item uk-logo uk-visible@m" href="/intel-smart-edge-open/ido-specs/">Intel&reg; Smart Edge Open</a>
                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas-docs" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Intel&reg; Smart Edge Open</span></a>
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/" >Home</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/docs/openness_releasenotes/" >Docs</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/release-notes/" >Release Notes</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></li>
                                                                                                        
                                
                            
                        
                    </ul>
                </div>
                <div class="uk-navbar-center uk-hidden@m">
                    <a class="uk-navbar-item uk-logo" href="/intel-smart-edge-open/ido-specs/">Docs</a>
                </div>
                <div class="uk-navbar-right">
                    
                        
                            <div>
                                <a id="search-navbar-toggle" class="uk-navbar-toggle" uk-search-icon href="#"></a>
                                <div class="uk-drop uk-background-default uk-border-rounded" uk-drop="mode: click; pos: left-center; offset: 0">
                                    <form class="uk-search uk-search-navbar uk-width-1-1" onsubmit="return false;">
                                        <input id="search-navbar" class="uk-search-input" type="search" placeholder="Search for answers" autofocus autocomplete="off">
                                    </form>
                                    <ul id="search-navbar-results" class="uk-position-absolute uk-width-1-1 uk-list"></ul>
                                </div>
                            </div>
                            <script>
                            SimpleJekyllSearch({
                                searchInput: document.getElementById('search-navbar'),
                                resultsContainer: document.getElementById('search-navbar-results'),
                                noResultsText: '<li class="no-results">No results found</li>',
                                searchResultTemplate: '<li><a href="{url}">{title}</a></li>',
                                json: "/intel-smart-edge-open/ido-specs/search.json"
                            });
                            searchResults("search-navbar");
                            </script>
                        
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-primary-outline" href="/intel-smart-edge-open/ido-specs/changelog-timeline/" >Changelog</a></div></li>
                                
                            
                        
                            
                            
                            
                                
                                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-success" href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></div></li>
                                
                            
                        
                    </ul>

                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Menu</span></a>
                    

                </div>
            </div>
        </div>
    </nav>
</div>
    

    <script src="/intel-smart-edge-open/ido-specs/assets/js/jquery.js"></script>
<link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/instantsearch.min.css" type="text/css" />
<link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/ido-specs.css" type="text/css" />
<script src="/intel-smart-edge-open/ido-specs/assets/js/instantsearch.min.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/bootstrap.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/doc-search.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/ido-specs.js"></script>
<div class="uk-section">
    <div class="uk-container">
        <div class="uk-grid-large" data-uk-grid>
            <div class="sidebar-fixed-width uk-visible@m">
                <div class="sidebar-docs uk-position-fixed">
                    <div class="container dashboardPage">
                        <div class="leftSection sideBar-wrap">
                            <div id="contact-button">
                                <div class="rotated-text">Quick Links <i class="fa-arrow-up"></i><i class="fa-arrow-down"></i></div>
                            </div>
                            <div class="searchBar-section">
                                <div class="input-section" data-toggle="popover" data-placement="bottom"></div>
                                <div class="output-section">
                                    <div id="search-result"></div>
                                    <div id="search-result-pagination"></div>
                                </div>
                            </div><!-- omit in toc -->
                            <div class="collapsedArea">
                                
                                
                                
                                
                                
                                    <h5>Overview</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/intel-smart-edge-open/request-license">Licensing</a></li>
                                    
                                    </ul>
                                
                                    <h5>Open - Apache 2.0</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    </ul>
                                
                                    <h5>Experience Kits (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/experience-kits/developer-experience-kit">Developer</a></li>
                                    
                                    </ul>
                                
                                    <h5>Building Blocks (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/core-pinning">Core Pinning</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/node-feature-discovery">Node Feature Discovery</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/networking/multus">Multus</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/networking/sriov-network-operator">SRIOV</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/topology-manager">Topology Manager</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/telemetry/telemetry">Telemetry</a></li>
                                    
                                    </ul>
                                
                                    <h5>Application Onboarding (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/application-onboarding/application-onboarding-cmdline">Onboarding Applications to an Intel® Smart Edge Open Single-Node Cluster</a></li>
                                    
                                    </ul>
                                
                                    <h5>Licensed - Intel Proprietary</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    </ul>
                                
                                    <h5>Getting Started (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/openness-cluster-setup">Cluster Setup</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/converged-edge-experience-kits">Converged Edge Experience Kits</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/offline-edge-deployment">Offline Deployment</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/non-root-user">Non-root User</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/harbor-registry">Harbor Registry Service</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/kubernetes-dashboards">Kubernetes Dashboard</a></li>
                                    
                                    </ul>
                                
                                    <h5>Experience Kits (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/cera_sdwan">uCPE</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/CERA-5G-On-Prem">Private Wireless</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/ran/openness_ran">Access Edge</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/CERA-Near-Edge">Near Edge</a></li>
                                    
                                    </ul>
                                
                                    <h5>Previous Building Blocks (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-interapp">Inter-app communication</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-ovn">OVN/OVS</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-userspace-cni">Userspace CNI</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-hugepage.md">Hugepage Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-node-feature-discovery">Node Feature Discovery</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-sriov-multiple-interfaces">Multiple Interface & PCIe SRIOV Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-dedicated-core">Dedicated CPU Core</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-bios">BIOS & Firmware Configuration</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-fpga">FPGA Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-acc100">Intel® vRAN Dedicated Accelerator ACC100</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness_hddl">Intel® Movidius™ Myriad™ X HDDL Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-vcac-a">Visual Compute Accelerator Card - Analytics (VCA-A)</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-qat">Intel QuickAssist Adapter</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-topology-manager">Topology Manager Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-telemetry">Telemetry Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-rmd">Resource Management Daemon</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/emco/openness-emco">Edge Multi-Cluster Orchestrator</a></li>
                                    
                                    </ul>
                                
                                    <h5>Application Onboarding (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/network-edge-applications-onboarding">Network Edge Application Onboarding</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-edgedns">Edge DNS</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-eaa">Edge Application Agent (EAA)</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-certsigner">Certificate Signing</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-interface-service">Interface Service</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-network-edge-vm-support">VM Support in Intel® Smart Edge Open for Network Edge</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/using-openness-cnca">Core Network Configuration Agent  (CNCA)</a></li>
                                    
                                    </ul>
                                
                                    <h5>Edge Applications (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/ran/openness_xran">O-RAN Front Haul Network Radio Access Network</a></li>
                                    
                                    </ul>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="uk-width-1-1 uk-width-expand@m">

                <article class="uk-article">

                    <h1 class="uk-article-title">Converged Edge Experience Kits</h1>

                    

                    <div class="uk-article-meta uk-flex uk-flex-middle">
                        <!--



<div>
  
  <time datetime="2021-09-29T23:11:19+05:30" itemprop="datePublished">
    
    Sep 29, 2021
  </time>
</div>-->
                    </div>

                    <div class="article-content link-primary">
                        <div class="language-text highlighter-rouge"><pre class="highlight"><code>SPDX-License-Identifier: Apache-2.0
Copyright (c) 2019-2021 Intel Corporation
</code></pre>
</div>
<!-- omit in toc -->
<h1 id="converged-edge-experience-kits">Converged Edge Experience Kits</h1>
<ul>
  <li><a href="#purpose">Purpose</a></li>
  <li><a href="#converged-edge-experience-kit-explained">Converged Edge Experience Kit explained</a></li>
  <li><a href="#the-inventory-file">The inventory file</a></li>
  <li><a href="#sample-deployment-definitions">Sample Deployment Definitions</a>
    <ul>
      <li><a href="#single-cluster-deployment">Single Cluster Deployment</a></li>
      <li><a href="#single-node-cluster-deployment">Single-node Cluster Deployment</a></li>
      <li><a href="#multi-cluster-deployment">Multi-cluster deployment</a></li>
    </ul>
  </li>
  <li><a href="#deployment-customization">Deployment customization</a></li>
  <li><a href="#customizing-kernel-grub-parameters-and-tuned-profile--variables-per-host">Customizing kernel, grub parameters, and tuned profile &amp; variables per host</a>
    <ul>
      <li><a href="#ip-address-range-allocation-for-various-cnis-and-interfaces">IP address range allocation for various CNIs and interfaces</a></li>
      <li><a href="#default-values">Default values</a></li>
      <li><a href="#use-different-realtime-kernel-3100-1062">Use different realtime kernel (3.10.0-1062)</a></li>
      <li><a href="#use-different-non-rt-kernel-3100-1062">Use different non-rt kernel (3.10.0-1062)</a></li>
      <li><a href="#use-tuned-29">Use tuned 2.9</a></li>
      <li><a href="#default-kernel-and-configure-tuned">Default kernel and configure tuned</a></li>
      <li><a href="#change-amount-of-hugepages">Change amount of HugePages</a></li>
      <li><a href="#change-size-of-hugepages">Change size of HugePages</a></li>
      <li><a href="#change-amount-and-size-of-hugepages">Change amount and size of HugePages</a></li>
      <li><a href="#remove-input-output-memory-management-unit-iommu-from-grub-params">Remove input output memory management unit (IOMMU) from grub params</a></li>
      <li><a href="#add-custom-grub-parameter">Add custom GRUB parameter</a></li>
      <li><a href="#configure-ovs-dpdk-in-kube-ovn">Configure OVS-DPDK in kube-ovn</a></li>
    </ul>
  </li>
  <li><a href="#adding-new-cni-plugins-for-kubernetes-network-edge">Adding new CNI plugins for Kubernetes (Network Edge)</a></li>
</ul>

<h2 id="purpose">Purpose</h2>

<p>The Converged Edge Experience Kit is a refreshed repository of Ansible* playbooks for automated deployment of Converged Edge Reference Architectures.</p>

<p>The Converged Edge Experience Kit introduces the following capabilities:</p>
<ol>
  <li>Wide range of deployments from individual building blocks to full end-to-end reference deployments</li>
  <li>Minimal to near-zero user interventions.. Typically, the user provides the details of the nodes that constitute the OpenNESS edge cluster and executes the deployment script</li>
  <li>More advanced deployments can be customized in the form of Ansible* group and host variables. This mode requires users with in-depth knowledge and expertise of the subject edge deployment</li>
  <li>Enablement of end-to-end multi-cluster deployments such as Near Edge and On-premises reference architectures</li>
</ol>

<h2 id="converged-edge-experience-kit-explained">Converged Edge Experience Kit explained</h2>
<p>The Converged Edge Experience Kit repository is organized as detailed in the following structure:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>├── cloud
├── flavors
├── inventory
│   ├── automated
│   └── default
│       ├── group_vars
│       │   └── all
│       │       └── 10-default.yml
│       └── host_vars
├── playbooks
│   ├── infrastructure.yml
│   ├── kubernetes.yml
│   └── applications.yml
├── roles
│   ├── applications
│   ├── infrastructure
│   ├── kubernetes
│   └── telemetry
├── scripts
├── tasks
├── inventory.yml
├── network_edge_cleanup.yml
└── deploy.py
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">flavors</code>: definition variables of pre-defined deployment flavors</li>
  <li><code class="highlighter-rouge">inventory</code>: definition of default &amp; generated Ansible* variables</li>
  <li><code class="highlighter-rouge">inventory/default/group_vars/all/10-default.yml</code>: definition of default variables for all deployments</li>
  <li><code class="highlighter-rouge">inventory/automated</code>: inventory files that were automatically generated by the deployment helper script</li>
  <li><code class="highlighter-rouge">playbooks</code>: Ansible* playbooks for infrastructure, Kubernetes and applications</li>
  <li><code class="highlighter-rouge">roles</code>: Ansible roles for infrastructure, Kubernetes, applications and telemetry</li>
  <li><code class="highlighter-rouge">scripts</code>: utility scripts</li>
  <li><code class="highlighter-rouge">inventory.yml</code>: definition of the clusters, their controller &amp; edge nodes and respective deployment flavors</li>
  <li><code class="highlighter-rouge">deploy.py</code>: the deployment helper script</li>
</ul>

<h2 id="the-inventory-file">The inventory file</h2>
<p>The inventory file defines the group of physical nodes that constitute the edge cluster which will be deployed by the Converged Edge Experience Kits. The inventory file YAML specification allows deploying multiple edge clusters in one command run. Multiple clusters must be separated by the 3 dashes <code class="highlighter-rouge">---</code> directive.</p>

<blockquote>
  <p><strong>NOTE</strong>: for multi-cluster deployments, user must assign distinct names to the controller and the edge nodes, i.e., no hostname repetitions.</p>
</blockquote>

<p>The following variables must be defined</p>

<ul>
  <li><code class="highlighter-rouge">cluster_name</code>: a given name for the OpenNESS edge cluster deployment - separated by underscores <code class="highlighter-rouge">_</code> instead of spaces.</li>
  <li><code class="highlighter-rouge">flavor</code>: the deployment flavor applicable for the OpenNESS edge deployment as defined in the <a href="../flavors.md">Deployment flavors</a> document.</li>
  <li><code class="highlighter-rouge">single_node_deployment</code>: If set to <code class="highlighter-rouge">true</code>, a single-node cluster is deployed.. Must satisfy the following conditions:
    <ul>
      <li>IP address (<code class="highlighter-rouge">ansible_host</code>) for both controller and node must be the same</li>
      <li><code class="highlighter-rouge">controller_group</code> and <code class="highlighter-rouge">edgenode_group</code> groups must contain exactly one host</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">limit</code> – <strong>OPTIONAL</strong>: constrains the deployment to a specific Ansible* group, e.g., <code class="highlighter-rouge">controller</code>, <code class="highlighter-rouge">edgenode</code>, <code class="highlighter-rouge">edgenode_vca_group</code> or just a particular hostname. This is passed as a <code class="highlighter-rouge">--limit</code> command-line option when executing <code class="highlighter-rouge">ansible-playbook</code>.</li>
</ul>

<h2 id="sample-deployment-definitions">Sample Deployment Definitions</h2>
<h3 id="single-cluster-deployment">Single Cluster Deployment</h3>
<p>Set <code class="highlighter-rouge">single_node_deployment</code> flag to <code class="highlighter-rouge">false</code> in the inventory file and provide the controller node name under the <code class="highlighter-rouge">controller_group</code> and the edge node names under the <code class="highlighter-rouge">edgenode_group</code>.</p>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="nn">---</span>
<span class="s">all</span><span class="pi">:</span>
  <span class="s">vars</span><span class="pi">:</span>
    <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_near_edge</span>
    <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_near_edge</span>
    <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">false</span>
    <span class="s">limit</span><span class="pi">:</span>
<span class="s">controller_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">ctrl.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.154</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node01.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.11</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
    <span class="s">node02.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.79</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_vca_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_master</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_slave_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
</div>

<h3 id="single-node-cluster-deployment">Single-node Cluster Deployment</h3>
<p>Set <code class="highlighter-rouge">single_node_deployment</code> flag to <code class="highlighter-rouge">true</code> in the inventory file and provide the node name in the <code class="highlighter-rouge">controller_group</code> and the <code class="highlighter-rouge">edgenode_group</code>.</p>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="nn">---</span>
<span class="s">all</span><span class="pi">:</span>
  <span class="s">vars</span><span class="pi">:</span>
    <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_central_office</span>
    <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_central_office</span>
    <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">true</span>   
    <span class="s">limit</span><span class="pi">:</span>  
<span class="s">controller_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_vca_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_master</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_slave_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
</div>

<h3 id="multi-cluster-deployment">Multi-cluster deployment</h3>
<p>Provide multiple clusters YAML specifications separated by the 3 dashes <code class="highlighter-rouge">---</code> directive in the inventory.yml. A node name should be used only once across the inventory file, i.e: distinct node names.</p>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="nn">---</span>
<span class="s">all</span><span class="pi">:</span>
  <span class="s">vars</span><span class="pi">:</span>
    <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_near_edge</span>
    <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_near_edge</span>
    <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">true</span> 
    <span class="s">limit</span><span class="pi">:</span>
<span class="s">controller_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness01.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.154</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness01.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.154</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_vca_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_master</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_slave_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="nn">---</span>
<span class="s">all</span><span class="pi">:</span>
  <span class="s">vars</span><span class="pi">:</span>
    <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_central_office</span>
    <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_central_office</span>
    <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">true</span>   
    <span class="s">limit</span><span class="pi">:</span>  
<span class="s">controller_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness02.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node.openness02.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_vca_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_master</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_slave_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
</div>

<h2 id="deployment-customization">Deployment customization</h2>
<p>The <code class="highlighter-rouge">deploy.py</code> script creates a new inventory for each cluster to be deployed in a <code class="highlighter-rouge">inventory/automated</code> directory. These inventories are based on <code class="highlighter-rouge">inventory/default</code> - all directories and files are symlinked. Additionally, relevant flavor files are symlinked.</p>

<p>Customizations made to <code class="highlighter-rouge">inventory/default/group_vars</code> and <code class="highlighter-rouge">inventory/default/host_vars</code> will affect every deployment performed by <code class="highlighter-rouge">deploy.py</code> (because these files are symlinked, not copied). Therefore it is a good place to provide changes relevant to the nodes of the cluster.</p>

<h2 id="customizing-kernel-grub-parameters-and-tuned-profile--variables-per-host">Customizing kernel, grub parameters, and tuned profile &amp; variables per host</h2>

<p>CEEKs allow a user to customize kernel, grub parameters, and tuned profiles by leveraging Ansible’s feature of <code class="highlighter-rouge">host_vars</code>.</p>

<blockquote>
  <p><strong>NOTE</strong>: <code class="highlighter-rouge">inventory/default/groups_vars/[edgenode|controller|edgenode_vca]_group</code> directories contain variables applicable for the respective groups and they can be used in <code class="highlighter-rouge">inventory/default/host_vars</code> to change on per node basis while <code class="highlighter-rouge">inventory/default/group_vars/all</code> contains cluster wide variables.</p>
</blockquote>

<p>CEEKs contain a <code class="highlighter-rouge">inventory/default/host_vars/</code> directory in which we can create another directory (<code class="highlighter-rouge">nodes-inventory-name</code>) and place a YAML file (<code class="highlighter-rouge">10-open.yml</code>, e.g., <code class="highlighter-rouge">node01/10-open.yml</code>). The file would contain variables that would override roles’ default values.</p>

<blockquote>
  <p><strong>NOTE</strong>: Despite the ability to customize parameters (kernel), it is required to have a clean CentOS* 7.9.2009 operating system installed on hosts (from a minimal ISO image) that will be later deployed from Ansible scripts. This OS shall not have any user customizations.</p>
</blockquote>

<p>To override the default value, place the variable’s name and new value in the host’s vars file. For example, the contents of <code class="highlighter-rouge">inventory/default/host_vars/node01/10-open.yml</code> that would result in skipping kernel customization on that node:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kernel_skip</span><span class="pi">:</span> <span class="s">true</span>
</code></pre>
</div>

<p>The following are several common customization scenarios.</p>

<h3 id="ip-address-range-allocation-for-various-cnis-and-interfaces">IP address range allocation for various CNIs and interfaces</h3>

<p>The Converged Edge Experience kits deployment uses/allocates/reserves a set of IP address ranges for different CNIs and interfaces. The server or host IP address should not conflict with the default address allocation.
In case if there is a critical need for the server IP address used by the OpenNESS default deployment, it would require to modify the default addresses used by the OpenNESS.</p>

<p>Following files specify the CIDR for CNIs and interfaces. These are the IP address ranges allocated and used by default just for reference.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">flavors/media-analytics-vca/all.yml:19:vca_cidr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">172.32.1.0/12"</span>
<span class="s">inventory/default/group_vars/all/10-open.yml:90:calico_cidr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10.245.0.0/16"</span>
<span class="s">inventory/default/group_vars/all/10-open.yml:93:flannel_cidr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10.244.0.0/16"</span>
<span class="s">inventory/default/group_vars/all/10-open.yml:96:weavenet_cidr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10.32.0.0/12"</span>
<span class="s">inventory/default/group_vars/all/10-open.yml:99:kubeovn_cidr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10.16.0.0/16,100.64.0.0/16,10.96.0.0/12"</span>
<span class="s">roles/kubernetes/cni/kubeovn/controlplane/templates/crd_local.yml.j2:13</span><span class="pi">:</span>  <span class="s">cidrBlock</span><span class="pi">:</span> <span class="s2">"</span><span class="s">192.168..0/24"</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">192.168.*.*</code> is used for SRIOV and interface service IP address allocation in Kube-ovn CNI. So it is not allowed for the server IP address, which conflicting with this range.
Completely avoid the range of address defined as per the netmask as it may conflict in routing rules.</p>

<p>E.g., If the server/host IP address is required to use <code class="highlighter-rouge">192.168.*.*</code> while this range by default used for SRIOV interfaces in OpenNESS. The IP address range for <code class="highlighter-rouge">cidrBlock</code> in <code class="highlighter-rouge">roles/kubernetes/cni/kubeovn/controlplane/templates/crd_local.yml.j2</code> file can be changed to <code class="highlighter-rouge">192.167..0/24</code> to use some other IP segment for SRIOV interfaces.</p>

<h3 id="default-values">Default values</h3>
<p>Here are several default values:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># --- machine_setup/custom_kernel</span>
<span class="s">kernel_skip</span><span class="pi">:</span> <span class="s">false</span>  <span class="c1"># use this variable to disable custom kernel installation for host</span>

<span class="s">kernel_repo_url</span><span class="pi">:</span> <span class="s">http://linuxsoft.cern.ch/cern/centos/7.9.2009/rt/CentOS-RT.repo</span>
<span class="s">kernel_repo_key</span><span class="pi">:</span> <span class="s">http://linuxsoft.cern.ch/cern/centos/7.9.2009/os/x86_64/RPM-GPG-KEY-cern</span>
<span class="s">kernel_package</span><span class="pi">:</span> <span class="s">kernel-rt-kvm</span>
<span class="s">kernel_devel_package</span><span class="pi">:</span> <span class="s">kernel-rt-devel</span>
<span class="s">kernel_version</span><span class="pi">:</span> <span class="s">3.10.0-1160.11.1.rt56.1145.el7.x86_64</span>

<span class="s">kernel_dependencies_urls</span><span class="pi">:</span> <span class="pi">[]</span>
<span class="s">kernel_dependencies_packages</span><span class="pi">:</span> <span class="pi">[]</span>

<span class="c1"># --- machine_setup/grub</span>
<span class="s">hugepage_size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2M"</span> <span class="c1"># Or 1G</span>
<span class="s">hugepage_amount</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5000"</span>

<span class="s">default_grub_params</span><span class="pi">:</span> <span class="s2">"</span><span class="s">hugepagesz=</span><span class="nv"> </span><span class="s">hugepages=</span><span class="nv"> </span><span class="s">intel_iommu=on</span><span class="nv"> </span><span class="s">iommu=pt"</span>
<span class="s">additional_grub_params</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>

<span class="c1"># --- machine_setup/configure_tuned</span>
<span class="s">tuned_skip</span><span class="pi">:</span> <span class="s">false</span>   <span class="c1"># use this variable to skip tuned profile configuration for host</span>
<span class="s">tuned_packages</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">tuned-2.11.0-9.el7</span>
  <span class="pi">-</span> <span class="s">http://ftp.scientificlinux.org/linux/scientific/7/x86_64/os/Packages/tuned-profiles-realtime-2.11.0-9.el7.noarch.rpm</span>
<span class="s">tuned_profile</span><span class="pi">:</span> <span class="s">realtime</span>
<span class="s">tuned_vars</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="no">isolated_cores=2-3</span>
  <span class="no">nohz=on</span>
  <span class="no">nohz_full=2-3</span>
</code></pre>
</div>

<h3 id="use-different-realtime-kernel-3100-1062">Use different realtime kernel (3.10.0-1062)</h3>
<p>By default, <code class="highlighter-rouge">kernel-rt-kvm-3.10.0-1160.11.1.rt56.1145.el7.x86_64</code> from the built-in repository is installed.</p>

<p>To use another version (e.g., <code class="highlighter-rouge">kernel-rt-kvm-3.10.0-1062.9.1.rt56.1033.el7.x86_64</code>), create a <code class="highlighter-rouge">host_var</code> file for the host with content:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kernel_version</span><span class="pi">:</span> <span class="s">3.10.0-1062.9.1.rt56.1033.el7.x86_64</span>
</code></pre>
</div>

<h3 id="use-different-non-rt-kernel-3100-1062">Use different non-rt kernel (3.10.0-1062)</h3>
<p>The CEEK installs a real-time kernel by default. However, the non-rt kernel is present in the official CentOS repository. Therefore, to use a different non-rt kernel, the following overrides must be applied:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kernel_repo_url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>                           <span class="c1"># package is in default repository, no need to add new repository</span>
<span class="s">kernel_package</span><span class="pi">:</span> <span class="s">kernel</span>                        <span class="c1"># instead of kernel-rt-kvm</span>
<span class="s">kernel_devel_package</span><span class="pi">:</span> <span class="s">kernel-devel</span>            <span class="c1"># instead of kernel-rt-devel</span>
<span class="s">kernel_version</span><span class="pi">:</span> <span class="s">3.10.0-1062.el7.x86_64</span>

<span class="s">dpdk_kernel_devel</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>  <span class="c1"># kernel-devel is in the repository, no need for url with RPM</span>

<span class="c1"># Since, we're not using rt kernel, we don't need a tuned-profiles-realtime but want to keep the tuned 2.11</span>
<span class="s">tuned_packages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">http://linuxsoft.cern.ch/scientific/7x/x86_64/os/Packages/tuned-2.11.0-8.el7.noarch.rpm</span>
<span class="s">tuned_profile</span><span class="pi">:</span> <span class="s">balanced</span>
<span class="s">tuned_vars</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
</code></pre>
</div>

<h3 id="use-tuned-29">Use tuned 2.9</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">tuned_packages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">tuned-2.9.0-1.el7fdp</span>
<span class="pi">-</span> <span class="s">tuned-profiles-realtime-2.9.0-1.el7fdp</span>
</code></pre>
</div>

<h3 id="default-kernel-and-configure-tuned">Default kernel and configure tuned</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kernel_skip</span><span class="pi">:</span> <span class="s">true</span>     <span class="c1"># skip kernel customization altogether</span>

<span class="c1"># update tuned to 2.11 but don't install tuned-profiles-realtime since we're not using rt kernel</span>
<span class="s">tuned_packages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">http://linuxsoft.cern.ch/scientific/7x/x86_64/os/Packages/tuned-2.11.0-8.el7.noarch.rpm</span>
<span class="s">tuned_profile</span><span class="pi">:</span> <span class="s">balanced</span>
<span class="s">tuned_vars</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
</code></pre>
</div>

<h3 id="change-amount-of-hugepages">Change amount of HugePages</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">hugepage_amount</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000"</span>   <span class="c1"># default is 5000</span>
</code></pre>
</div>

<h3 id="change-size-of-hugepages">Change size of HugePages</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">hugepage_size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1G"</span>   <span class="c1"># default is 2M</span>
</code></pre>
</div>

<h3 id="change-amount-and-size-of-hugepages">Change amount and size of HugePages</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">hugepage_amount</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10"</span>   <span class="c1"># default is 5000</span>
<span class="s">hugepage_size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1G"</span>     <span class="c1"># default is 2M</span>
</code></pre>
</div>

<h3 id="remove-input-output-memory-management-unit-iommu-from-grub-params">Remove input output memory management unit (IOMMU) from grub params</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">default_grub_params</span><span class="pi">:</span> <span class="s2">"</span><span class="s">hugepagesz=</span><span class="nv"> </span><span class="s">hugepages="</span>
</code></pre>
</div>

<h3 id="add-custom-grub-parameter">Add custom GRUB parameter</h3>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">additional_grub_params</span><span class="pi">:</span> <span class="s2">"</span><span class="s">debug"</span>
</code></pre>
</div>

<h3 id="configure-ovs-dpdk-in-kube-ovn">Configure OVS-DPDK in kube-ovn</h3>
<p>By default, OVS-DPDK is disabled (due to set calico as a default cni). To enable it, set a flag:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubeovn_dpdk</span><span class="pi">:</span> <span class="s">true</span>
</code></pre>
</div>

<blockquote>
  <p><strong>NOTE</strong>: This flag should be set in <code class="highlighter-rouge">roles/kubernetes/cni/kubeovn/common/defaults/main.ym</code> or added to <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>.</p>
</blockquote>

<p>Additionally, HugePages in the OVS pod can be adjusted once default HugePage settings are changed.</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubeovn_dpdk_socket_mem</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1024,0"</span> <span class="c1"># Amount of hugepages reserved for OVS per NUMA node (node 0, node 1, ...) in MB</span>
<span class="s">kubeovn_dpdk_hugepage_size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2Mi"</span> <span class="c1"># Default size of hugepages, can be 2Mi or 1Gi</span>
<span class="s">kubeovn_dpdk_hugepages</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>     <span class="c1"># Total amount of hugepages that can be used by OVS-OVN pod</span>
</code></pre>
</div>

<blockquote>
  <p><strong>NOTE</strong>: If the machine has multiple NUMA nodes, remember that HugePages must be allocated for <strong>each NUMA node</strong>. For example, if a machine has two NUMA nodes, <code class="highlighter-rouge">kubeovn_dpdk_socket_mem: "1024,1024"</code> or similar should be specified.</p>
</blockquote>

<blockquote>
  <p><strong>NOTE</strong>: If <code class="highlighter-rouge">kubeovn_dpdk_socket_mem</code> is changed, set the value of <code class="highlighter-rouge">kubeovn_dpdk_hugepages</code> to be equal to or greater than the sum of <code class="highlighter-rouge">kubeovn_dpdk_socket_mem</code> values. For example, for <code class="highlighter-rouge">kubeovn_dpdk_socket_mem: "1024,1024"</code>, set <code class="highlighter-rouge">kubeovn_dpdk_hugepages</code> to at least <code class="highlighter-rouge">2Gi</code> (equal to 2048 MB).</p>
</blockquote>

<blockquote>
  <p><strong>NOTE</strong>: <code class="highlighter-rouge">kubeovn_dpdk_socket_mem</code>, <code class="highlighter-rouge">kubeovn_dpdk_pmd_cpu_mask</code>, and <code class="highlighter-rouge">kubeovn_dpdk_lcore_mask</code> can be set on per node basis but the HugePage amount allocated with <code class="highlighter-rouge">kubeovn_dpdk_socket_mem</code> cannot be greater than <code class="highlighter-rouge">kubeovn_dpdk_hugepages</code>, which is the same for the whole cluster.</p>
</blockquote>

<p>OVS pods limits are configured by:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubeovn_dpdk_resources_requests</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span> <span class="c1"># OVS-OVN pod RAM memory (requested)</span>
<span class="s">kubeovn_dpdk_resources_limits</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>   <span class="c1"># OVS-OVN pod RAM memory (limit)</span>
</code></pre>
</div>
<p>CPU settings can be configured using:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubeovn_dpdk_pmd_cpu_mask</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0x4"</span> <span class="c1"># DPDK PMD CPU mask</span>
<span class="s">kubeovn_dpdk_lcore_mask</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0x2"</span>   <span class="c1"># DPDK lcore mask</span>
</code></pre>
</div>

<h2 id="adding-new-cni-plugins-for-kubernetes-network-edge">Adding new CNI plugins for Kubernetes (Network Edge)</h2>

<ul>
  <li>The role that handles CNI deployment must be placed in the <code class="highlighter-rouge">roles/kubernetes/cni/</code> directory (e.g., <code class="highlighter-rouge">roles/kubernetes/cni/kube-ovn/</code>).</li>
  <li>Subroles for control plane and node (if needed) should be placed in the <code class="highlighter-rouge">controlplane/</code> and <code class="highlighter-rouge">node/</code> directories (e.g., <code class="highlighter-rouge">roles/kubernetes/cni/kube-ovn/{controlplane,node}</code>).</li>
  <li>If there is a part of common command for both control plane and node, additional sub-roles can be created: <code class="highlighter-rouge">common</code> (e.g., <code class="highlighter-rouge">roles/kubernetes/cni/sriov/common</code>).<br />
    <blockquote>
      <p><strong>NOTE</strong>: The automatic inclusion of the <code class="highlighter-rouge">common</code> role should be handled by Ansible mechanisms (e.g., usage of meta’s <code class="highlighter-rouge">dependencies</code> or <code class="highlighter-rouge">include_role</code> module)</p>
    </blockquote>
  </li>
  <li>Name of the main role must be added to the <code class="highlighter-rouge">available_kubernetes_cnis</code> variable in <code class="highlighter-rouge">roles/kubernetes/cni/defaults/main.yml</code>.</li>
  <li>If additional requirements must checked before running the playbook (to not have errors during execution), they can be placed in the <code class="highlighter-rouge">roles/kubernetes/cni/tasks/precheck.yml</code> file, which is included as a pre_task in plays for both Edge Controller and Edge Node.<br />
The following are basic prechecks that are currently executed:
    <ul>
      <li>Check if any CNI is requested (i.e., <code class="highlighter-rouge">kubernetes_cni</code> is not empty).</li>
      <li>Check if <code class="highlighter-rouge">sriov</code> is not requested as primary (first on the list) or standalone (only on the list).</li>
      <li>Check if <code class="highlighter-rouge">calico</code> is requested as a primary (first on the list).</li>
      <li>Check if <code class="highlighter-rouge">kubeovn</code> is requested as a primary (first on the list).</li>
      <li>Check if the requested CNI is available (check if some CNI is requested that isn’t present in the <code class="highlighter-rouge">available_kubernetes_cnis</code> list).</li>
    </ul>
  </li>
  <li>CNI roles should be as self-contained as possible (unless necessary, CNI-specific tasks should not be present in <code class="highlighter-rouge">kubernetes/{controlplane,node,common}</code> or <code class="highlighter-rouge">openness/network_edge/{controlplane,node}</code>).</li>
  <li>If the CNI needs a custom OpenNESS service (e.g., Interface Service in case of <code class="highlighter-rouge">kube-ovn</code>), it can be added to the <code class="highlighter-rouge">openness/network_edge/{controlplane,node}</code>.<br />
Preferably, such tasks would be contained in a separate task file (e.g., <code class="highlighter-rouge">roles/openness/controlplane/tasks/kube-ovn.yml</code>) and executed only if the CNI is requested. For example:
```yaml
    <ul>
      <li>name: deploy interface service for kube-ovn
include_tasks: kube-ovn.yml
when: “‘kubeovn’ in kubernetes_cnis”
```</li>
    </ul>
  </li>
  <li>If the CNI is used as an additional CNI (with Multus*), the network attachment definition must be supplied (<a href="https://github.com/intel/multus-cni/blob/master/docs/quickstart.md#storing-a-configuration-as-a-custom-resource">refer to Multus docs for more info</a>).</li>
</ul>

                        
                        <!--<div class="share uk-text-center uk-margin-medium-top">
    
        <a class="uk-link-muted" href="https://twitter.com/intent/tweet?text=Converged Edge Experience Kits&url=http://localhost:4000/docs/getting-started/converged-edge-experience-kits/&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter" onclick="window.open(this.href, 'twitter', 'width=550,height=235');return false;"><span data-uk-icon="icon: twitter; ratio: 1.2"></span></a>
    
    
        <a class="uk-link-muted uk-margin-small-left" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdocs%2Fgetting-started%2Fconverged-edge-experience-kits%2F" rel="nofollow" target="_blank" title="Share on Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><span data-uk-icon="icon: facebook; ratio: 1.2"></span></a>
    
</div>-->

                        
                    </div>

                    

                    <hr class="uk-margin-medium">

                    




                    <!--<div class="uk-margin-large-top">
    <h3>Related Docs</h3>

    
    
    

    <ul class="uk-list link-secondary">
    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    
    </ul>
</div>-->


                    
                </article>

                <script>
                    // Table of contents scroll to
                    UIkit.scroll('#markdown-toc a', {
                        duration: 400,
                        offset: 120
                    });
                </script>

            </div>
    </div>
</div>


    <div id="offcanvas-docs" data-uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar">

        <button class="uk-offcanvas-close" type="button" data-uk-close></button>

        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        

    </div>
</div>


    <div id="offcanvas" data-uk-offcanvas="flip: true; overlay: true">
    <div class="uk-offcanvas-bar">

        <a class="uk-logo uk-margin-small-bottom" href="/intel-smart-edge-open/ido-specs/">Docs</a>
     
        <button class="uk-offcanvas-close" type="button" data-uk-close></button>
      
        <ul class="uk-nav uk-nav-primary uk-margin-top">
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/" >Home</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/docs/installation/" >Docs</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/blog/" >Blog</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/changelog-timeline/" >Changelog</a></li>
                
            
                

                

                
                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-success" href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></div></li>
                
            
        </ul>

        <div class="uk-margin-top uk-text-center">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                
<div class="uk-first-column">
    <a href="https://twitter.com/" data-uk-icon="icon: twitter" class="uk-icon-link uk-icon" target="_blank"></a>
</div>


<div>
    <a href="https://www.facebook.com/" data-uk-icon="icon: facebook" class="uk-icon-link uk-icon" target="_blank"></a>
</div>




<div>
    <a href="https://www.instagram.com/" data-uk-icon="icon: instagram" class="uk-icon-link uk-icon" target="_blank"></a>
</div>





<div>
    <a href="https://vimeo.com/" data-uk-icon="icon: vimeo" class="uk-icon-link uk-icon" target="_blank"></a>
</div>






            </div>
        </div>

    </div>
</div>


   <!--   -->

    
        
    

    

    </body>

</html>
