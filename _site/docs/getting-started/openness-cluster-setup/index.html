<!DOCTYPE html>
<html lang="en">

    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Openness Cluster Setup | Docs</title>
<meta name="generator" content="Jekyll v3.4.1" />
<meta property="og:title" content="Openness Cluster Setup" />
<meta property="og:locale" content="en" />
<meta name="description" content="SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation OpenNESS Network Edge: Controller and Edge node setup Quickstart Preconditions Running playbooks Deployment scripts Network Edge playbooks Cleanup procedure Supported EPA features VM support for Network Edge Application on-boarding Single-node Network Edge cluster Kubernetes cluster networking plugins (Network Edge) Selecting cluster networking plugins (CNI) Adding additional interfaces to pods Q&amp;A Configuring time Setup static hostname Configuring the Inventory file Exchanging SSH keys between hosts Setting proxy Obtaining installation files Setting Git GitHub token Customize tag/branch/sha to checkout on edgeservices repository Customization of kernel, grub parameters, and tuned profile" />
<meta property="og:description" content="SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation OpenNESS Network Edge: Controller and Edge node setup Quickstart Preconditions Running playbooks Deployment scripts Network Edge playbooks Cleanup procedure Supported EPA features VM support for Network Edge Application on-boarding Single-node Network Edge cluster Kubernetes cluster networking plugins (Network Edge) Selecting cluster networking plugins (CNI) Adding additional interfaces to pods Q&amp;A Configuring time Setup static hostname Configuring the Inventory file Exchanging SSH keys between hosts Setting proxy Obtaining installation files Setting Git GitHub token Customize tag/branch/sha to checkout on edgeservices repository Customization of kernel, grub parameters, and tuned profile" />
<link rel="canonical" href="http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/openness-cluster-setup/" />
<meta property="og:url" content="http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/openness-cluster-setup/" />
<meta property="og:site_name" content="Docs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-29T23:11:19+05:30" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/openness-cluster-setup/"},"datePublished":"2021-09-29T23:11:19+05:30","headline":"Openness Cluster Setup","url":"http://localhost:4000/intel-smart-edge-open/ido-specs/docs/getting-started/openness-cluster-setup/","description":"SPDX-License-Identifier: Apache-2.0 Copyright (c) 2019-2021 Intel Corporation OpenNESS Network Edge: Controller and Edge node setup Quickstart Preconditions Running playbooks Deployment scripts Network Edge playbooks Cleanup procedure Supported EPA features VM support for Network Edge Application on-boarding Single-node Network Edge cluster Kubernetes cluster networking plugins (Network Edge) Selecting cluster networking plugins (CNI) Adding additional interfaces to pods Q&amp;A Configuring time Setup static hostname Configuring the Inventory file Exchanging SSH keys between hosts Setting proxy Obtaining installation files Setting Git GitHub token Customize tag/branch/sha to checkout on edgeservices repository Customization of kernel, grub parameters, and tuned profile","dateModified":"2021-09-29T23:11:19+05:30","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta property="og:image" content="http://localhost:4000/intel-smart-edge-open/ido-specs/uploads/"/>
  <!-- <link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/main.css"> -->
  <link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/custom.css">
  <link rel="shortcut icon" type="image/png" href="/intel-smart-edge-open/ido-specs/uploads/favicon.png" >
  <link rel="alternate" type="application/rss+xml" title="Docs" href="/intel-smart-edge-open/ido-specs/feed.xml">
  <script type="text/javascript" src="/intel-smart-edge-open/ido-specs/assets/js/jquery.js"></script>
  <script src="/intel-smart-edge-open/ido-specs/assets/js/main.js"></script>
  
    <script>
function searchResults(form) {

    var currentItem = null;
    var search = document.getElementById(form);
    var results = document.getElementById(form + "-results");
    var toggle = document.getElementById(form + "-toggle");

    function removeActive() {
        for (i = 0; i < results.children.length; i++) {
            results.children[i].classList.remove("uk-background-muted");
        }
    }

    // Detect all clicks on the document
    document.addEventListener("click", function(event) {

        var isClickSearch = false;
        var isClickResults = false;
        var isClickSearchToggle = false;

        if (search !== null) {
            isClickSearch = search.contains(event.target);
        }

        if (results !== null) {
            isClickResults = results.contains(event.target);
        }

        if (toggle !== null) {
            isClickSearchToggle = toggle.contains(event.target);
        }

        if (isClickSearch || isClickSearchToggle) {
            results.style.display = "block";
        }        

        if (!isClickResults && !isClickSearch && !isClickSearchToggle) {
            results.style.display = "none";
        }        
        
    });    

    results.addEventListener("mouseover", function(event) {

        removeActive();
        event.target.parentElement.classList.add("uk-background-muted");
        currentItem = null;

    });

    results.addEventListener("mouseout", function(event) {
        event.target.parentElement.classList.remove("uk-background-muted");
    });


    search.addEventListener("keyup", function(event) {

        var resultItems = results.children;
        var resultCount = results.children.length;
                                
        if (event.keyCode === 40) {

            if (currentItem < (resultCount - 1)) {
                if (currentItem === null) {
                    currentItem = 0;
                } else {
                    removeActive();
                    currentItem++;
                }
                removeActive();
                resultItems[currentItem].classList.add("uk-background-muted");
            }
            
        } else if (event.keyCode === 38) {

            if (currentItem > 0) {
                if (currentItem === null) {
                    currentItem = 0;
                } else {
                    removeActive();
                    currentItem--;
                }
                removeActive();
                resultItems[currentItem].classList.add("uk-background-muted");
            }

        } else if (event.keyCode === 13) {

            resultItems[currentItem].children[0].click();

        }

    });

}
</script>
  
  
  
</head>

    <body>

    
        <div data-uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 200">
    <nav class="uk-navbar-container">
        <div class="uk-container">
            <div data-uk-navbar>
                <div class="uk-navbar-left">
                    <!-- <a class="uk-navbar-item uk-logo uk-visible@m" href="/intel-smart-edge-open/ido-specs/">Docs</a> -->
                    <a class="uk-navbar-item uk-logo uk-visible@m" href="/intel-smart-edge-open/ido-specs/">Intel&reg; Smart Edge Open</a>
                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas-docs" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Intel&reg; Smart Edge Open</span></a>
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/" >Home</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/docs/openness_releasenotes/" >Docs</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/release-notes/" >Release Notes</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></li>
                                                                                                        
                                
                            
                        
                    </ul>
                </div>
                <div class="uk-navbar-center uk-hidden@m">
                    <a class="uk-navbar-item uk-logo" href="/intel-smart-edge-open/ido-specs/">Docs</a>
                </div>
                <div class="uk-navbar-right">
                    
                        
                            <div>
                                <a id="search-navbar-toggle" class="uk-navbar-toggle" uk-search-icon href="#"></a>
                                <div class="uk-drop uk-background-default uk-border-rounded" uk-drop="mode: click; pos: left-center; offset: 0">
                                    <form class="uk-search uk-search-navbar uk-width-1-1" onsubmit="return false;">
                                        <input id="search-navbar" class="uk-search-input" type="search" placeholder="Search for answers" autofocus autocomplete="off">
                                    </form>
                                    <ul id="search-navbar-results" class="uk-position-absolute uk-width-1-1 uk-list"></ul>
                                </div>
                            </div>
                            <script>
                            SimpleJekyllSearch({
                                searchInput: document.getElementById('search-navbar'),
                                resultsContainer: document.getElementById('search-navbar-results'),
                                noResultsText: '<li class="no-results">No results found</li>',
                                searchResultTemplate: '<li><a href="{url}">{title}</a></li>',
                                json: "/intel-smart-edge-open/ido-specs/search.json"
                            });
                            searchResults("search-navbar");
                            </script>
                        
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-primary-outline" href="/intel-smart-edge-open/ido-specs/changelog-timeline/" >Changelog</a></div></li>
                                
                            
                        
                            
                            
                            
                                
                                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-success" href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></div></li>
                                
                            
                        
                    </ul>

                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Menu</span></a>
                    

                </div>
            </div>
        </div>
    </nav>
</div>
    

    <script src="/intel-smart-edge-open/ido-specs/assets/js/jquery.js"></script>
<link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/instantsearch.min.css" type="text/css" />
<link rel="stylesheet" href="/intel-smart-edge-open/ido-specs/assets/css/ido-specs.css" type="text/css" />
<script src="/intel-smart-edge-open/ido-specs/assets/js/instantsearch.min.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/bootstrap.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/doc-search.js"></script>
<script src="/intel-smart-edge-open/ido-specs/assets/js/ido-specs.js"></script>
<div class="uk-section">
    <div class="uk-container">
        <div class="uk-grid-large" data-uk-grid>
            <div class="sidebar-fixed-width uk-visible@m">
                <div class="sidebar-docs uk-position-fixed">
                    <div class="container dashboardPage">
                        <div class="leftSection sideBar-wrap">
                            <div id="contact-button">
                                <div class="rotated-text">Quick Links <i class="fa-arrow-up"></i><i class="fa-arrow-down"></i></div>
                            </div>
                            <div class="searchBar-section">
                                <div class="input-section" data-toggle="popover" data-placement="bottom"></div>
                                <div class="output-section">
                                    <div id="search-result"></div>
                                    <div id="search-result-pagination"></div>
                                </div>
                            </div><!-- omit in toc -->
                            <div class="collapsedArea">
                                
                                
                                
                                
                                
                                    <h5>Overview</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/intel-smart-edge-open/request-license">Licensing</a></li>
                                    
                                    </ul>
                                
                                    <h5>Open - Apache 2.0</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    </ul>
                                
                                    <h5>Experience Kits (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/experience-kits/developer-experience-kit">Developer</a></li>
                                    
                                    </ul>
                                
                                    <h5>Building Blocks (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/core-pinning">Core Pinning</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/node-feature-discovery">Node Feature Discovery</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/networking/multus">Multus</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/networking/sriov-network-operator">SRIOV</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/resource-management/topology-manager">Topology Manager</a></li>
                                    
                                    
                                    <li class=""><a href="/docs/components/telemetry/telemetry">Telemetry</a></li>
                                    
                                    </ul>
                                
                                    <h5>Application Onboarding (Open)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/docs/application-onboarding/application-onboarding-cmdline">Onboarding Applications to an Intel® Smart Edge Open Single-Node Cluster</a></li>
                                    
                                    </ul>
                                
                                    <h5>Licensed - Intel Proprietary</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    </ul>
                                
                                    <h5>Getting Started (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/openness-cluster-setup">Cluster Setup</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/converged-edge-experience-kits">Converged Edge Experience Kits</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/offline-edge-deployment">Offline Deployment</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/non-root-user">Non-root User</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/harbor-registry">Harbor Registry Service</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/getting-started/kubernetes-dashboards">Kubernetes Dashboard</a></li>
                                    
                                    </ul>
                                
                                    <h5>Experience Kits (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/cera_sdwan">uCPE</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/CERA-5G-On-Prem">Private Wireless</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/ran/openness_ran">Access Edge</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/CERA-Near-Edge">Near Edge</a></li>
                                    
                                    </ul>
                                
                                    <h5>Previous Building Blocks (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-interapp">Inter-app communication</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-ovn">OVN/OVS</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/dataplane/openness-userspace-cni">Userspace CNI</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-hugepage.md">Hugepage Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-node-feature-discovery">Node Feature Discovery</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-sriov-multiple-interfaces">Multiple Interface & PCIe SRIOV Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-dedicated-core">Dedicated CPU Core</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-bios">BIOS & Firmware Configuration</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-fpga">FPGA Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-acc100">Intel® vRAN Dedicated Accelerator ACC100</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness_hddl">Intel® Movidius™ Myriad™ X HDDL Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-vcac-a">Visual Compute Accelerator Card - Analytics (VCA-A)</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-qat">Intel QuickAssist Adapter</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-topology-manager">Topology Manager Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-telemetry">Telemetry Support</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/enhanced-platform-awareness/openness-rmd">Resource Management Daemon</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/building-blocks/emco/openness-emco">Edge Multi-Cluster Orchestrator</a></li>
                                    
                                    </ul>
                                
                                    <h5>Application Onboarding (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/network-edge-applications-onboarding">Network Edge Application Onboarding</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-edgedns">Edge DNS</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-eaa">Edge Application Agent (EAA)</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-certsigner">Certificate Signing</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-interface-service">Interface Service</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/openness-network-edge-vm-support">VM Support in Intel® Smart Edge Open for Network Edge</a></li>
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/applications-onboard/using-openness-cnca">Core Network Configuration Agent  (CNCA)</a></li>
                                    
                                    </ul>
                                
                                    <h5>Edge Applications (Licensed)</h5>
                                    <ul class="uk-nav uk-nav-default doc-nav">
                                    
                                    
                                    
                                    <li class=""><a href="/ido-specs/docs/reference-architectures/ran/openness_xran">O-RAN Front Haul Network Radio Access Network</a></li>
                                    
                                    </ul>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="uk-width-1-1 uk-width-expand@m">

                <article class="uk-article">

                    <h1 class="uk-article-title">Openness Cluster Setup</h1>

                    

                    <div class="uk-article-meta uk-flex uk-flex-middle">
                        <!--



<div>
  
  <time datetime="2021-09-29T23:11:19+05:30" itemprop="datePublished">
    
    Sep 29, 2021
  </time>
</div>-->
                    </div>

                    <div class="article-content link-primary">
                        <div class="language-text highlighter-rouge"><pre class="highlight"><code>SPDX-License-Identifier: Apache-2.0
Copyright (c) 2019-2021 Intel Corporation
</code></pre>
</div>
<!-- omit in toc -->
<h1 id="openness-network-edge-controller-and-edge-node-setup">OpenNESS Network Edge: Controller and Edge node setup</h1>
<ul>
  <li><a href="#quickstart">Quickstart</a></li>
  <li><a href="#preconditions">Preconditions</a></li>
  <li><a href="#running-playbooks">Running playbooks</a>
    <ul>
      <li><a href="#deployment-scripts">Deployment scripts</a></li>
      <li><a href="#network-edge-playbooks">Network Edge playbooks</a>
        <ul>
          <li><a href="#cleanup-procedure">Cleanup procedure</a></li>
          <li><a href="#supported-epa-features">Supported EPA features</a></li>
          <li><a href="#vm-support-for-network-edge">VM support for Network Edge</a></li>
          <li><a href="#application-on-boarding">Application on-boarding</a></li>
          <li><a href="#single-node-network-edge-cluster">Single-node Network Edge cluster</a></li>
        </ul>
      </li>
      <li><a href="#kubernetes-cluster-networking-plugins-network-edge">Kubernetes cluster networking plugins (Network Edge)</a>
        <ul>
          <li><a href="#selecting-cluster-networking-plugins-cni">Selecting cluster networking plugins (CNI)</a></li>
          <li><a href="#adding-additional-interfaces-to-pods">Adding additional interfaces to pods</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#qa">Q&amp;A</a>
    <ul>
      <li><a href="#configuring-time">Configuring time</a></li>
      <li><a href="#setup-static-hostname">Setup static hostname</a></li>
      <li><a href="#configuring-the-inventory-file">Configuring the Inventory file</a></li>
      <li><a href="#exchanging-ssh-keys-between-hosts">Exchanging SSH keys between hosts</a></li>
      <li><a href="#setting-proxy">Setting proxy</a></li>
      <li><a href="#obtaining-installation-files">Obtaining installation files</a></li>
      <li><a href="#setting-git">Setting Git</a>
        <ul>
          <li><a href="#github-token">GitHub token</a></li>
          <li><a href="#customize-tagbranchsha-to-checkout-on-edgeservices-repository">Customize tag/branch/sha to checkout on edgeservices repository</a></li>
        </ul>
      </li>
      <li><a href="#customization-of-kernel-grub-parameters-and-tuned-profile">Customization of kernel, grub parameters, and tuned profile</a></li>
    </ul>
  </li>
</ul>

<h1 id="quickstart">Quickstart</h1>
<p>The following set of actions must be completed to set up the Open Network Edge Services Software (OpenNESS) cluster.</p>

<ol>
  <li>Fulfill the <a href="#preconditions">Preconditions</a>.</li>
  <li>Become familiar with <a href="#supported-epa-features">supported features</a> and enable them if desired.</li>
  <li>Clone <a href="https://github.com/open-ness/converged-edge-experience-kits">Converged Edge Experience Kits</a></li>
  <li>
    <p>Install deployment helper script pre-requisites (first time only)</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>sudo scripts/ansible-precheck.sh
</code></pre>
    </div>
  </li>
  <li>
    <p>Run the <a href="#running-playbooks">deployment helper script</a> for the Ansible* playbook:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>python3 deploy.py
</code></pre>
    </div>
  </li>
</ol>

<h1 id="preconditions">Preconditions</h1>

<p>To use the playbooks, several preconditions must be fulfilled. These preconditions are described in the <a href="#qa">Q&amp;A</a> section below. The preconditions are:</p>

<ul>
  <li>CentOS* 7.9.2009 must be installed on all the nodes (the controller and edge nodes) where the product is deployed. It is highly recommended to install the operating system using a minimal ISO image on nodes that will take part in deployment (obtained from inventory file). Also, do not make customizations after a fresh manual install because it might interfere with Ansible scripts and give unpredictable results during deployment.</li>
  <li>Hosts for the Edge Controller (Kubernetes control plane) and Edge Nodes (Kubernetes nodes) must have proper and unique hostnames (i.e., not <code class="highlighter-rouge">localhost</code>). This hostname must be specified in <code class="highlighter-rouge">/etc/hosts</code> (refer to <a href="#setup-static-hostname">Setup static hostname</a>).</li>
  <li>SSH keys must be exchanged between hosts (refer to <a href="#exchanging-ssh-keys-between-hosts">Exchanging SSH keys between hosts</a>).</li>
  <li>A proxy may need to be set (refer to <a href="#setting-proxy">Setting proxy</a>).</li>
  <li>If a private repository is used, a Github* token must be set up (refer to <a href="#github-token">GitHub token</a>).</li>
  <li>Refer to the <a href="#configuring-time">Configuring time</a> section for how to enable Network Time Protocol (NTP) clients.</li>
  <li>The Ansible inventory must be configured (refer to <a href="#configuring-the-inventory-file">Configuring the Inventory file</a>).</li>
</ul>

<h1 id="running-playbooks">Running playbooks</h1>

<p>The Network Edge deployment and cleanup is carried out via Ansible playbooks. The playbooks are run from the Ansible host. Before running the playbooks, an inventory file <code class="highlighter-rouge">inventory.yml</code> must be defined. The provided <a href="#deployment-scripts">deployment helper scripts</a> support deploying multiple clusters as defined in the Inventory file.</p>

<p>The following subsections describe the playbooks in more details.</p>

<h2 id="deployment-scripts">Deployment scripts</h2>

<p>For convenience, playbooks can be executed by running helper deployment scripts from the Ansible host. These scripts require that the Edge Controller and Edge Nodes be configured on different hosts (for deployment on a single node, refer to <a href="#single-node-network-edge-cluster">Single-node Network Edge cluster</a>). This is done by configuring the Ansible playbook inventory, as described later in this document.</p>

<p>To get started with deploying an OpenNESS edge cluster using the Converged Edge Experience Kit:</p>

<ol>
  <li>
    <p>Install pre-requisite tools for the the deployment script</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>sudo scripts/ansible-precheck.sh
</code></pre>
    </div>
  </li>
  <li>
    <p>Edit the <code class="highlighter-rouge">inventory.yml</code> file by providing information about the cluster nodes and the intended deployment flavor</p>

    <p>Example:</p>

    <div class="language-yaml highlighter-rouge"><pre class="highlight"><code> <span class="s">---</span>
 <span class="s">all</span><span class="pi">:</span>
   <span class="s">vars</span><span class="pi">:</span>
     <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_near_edge</span>
     <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_near_edge</span>
     <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">false</span>
     <span class="s">limit</span><span class="pi">:</span>
 <span class="s">controller_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
     <span class="s">ctrl.openness.org</span><span class="pi">:</span>
       <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.154</span>
       <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
 <span class="s">edgenode_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
     <span class="s">node01.openness.org</span><span class="pi">:</span>
       <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.11</span>
       <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
     <span class="s">node02.openness.org</span><span class="pi">:</span>
       <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.79</span>
       <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
 <span class="s">edgenode_vca_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
 <span class="s">ptp_master</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
 <span class="s">ptp_slave_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
    </div>

    <blockquote>
      <p><strong>NOTE</strong>: To deploy multiple clusters in one command run, append the same set of YAML specs separated by <code class="highlighter-rouge">---</code></p>
    </blockquote>
  </li>
  <li>
    <p>Additional configurations should be applied to the default group_vars file: <code class="highlighter-rouge">inventory/default/group_vars/all/10-default.yml</code>. More details on the default values is explained in the <a href="../converged-edge-experience-kits.md#default-values">Getting Started Guide</a>.</p>
  </li>
  <li>
    <p>Get the deployment started by executing the deploy script</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>python3 deploy.py
</code></pre>
    </div>
    <blockquote>
      <p><strong>NOTE</strong>: This script parses the values provided in the inventory.yml file.</p>
    </blockquote>

    <blockquote>
      <p><strong>NOTE</strong>: If want to enforce deployment termination in case of any failure, use arguments <code class="highlighter-rouge">-f</code> or <code class="highlighter-rouge">--any-errors-fatal</code>, e.g.:</p>
      <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>python3 deploy.py --any-errors-fatal
</code></pre>
      </div>
    </blockquote>
  </li>
  <li>
    <p>To cleanup an existing deployment, execute with <code class="highlighter-rouge">-c</code> or <code class="highlighter-rouge">--clean</code>, e.g:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>python3 deploy.py --clean
</code></pre>
    </div>
    <blockquote>
      <p><strong>NOTE</strong>: If it is intended to do the cleanup manually, i.e: one cluster at a time, update the <code class="highlighter-rouge">inventory.yml</code> with only the intended cluster configuration</p>
    </blockquote>
  </li>
</ol>

<p>For an initial installation, <code class="highlighter-rouge">deploy.py</code> with <code class="highlighter-rouge">all/vars/limit: controller</code> must be run before <code class="highlighter-rouge">deploy.py</code> with <code class="highlighter-rouge">all/vars/limit: nodes</code>. During the initial installation, the hosts may reboot. After reboot, the deployment script that was last run should be run again.</p>

<h2 id="network-edge-playbooks">Network Edge playbooks</h2>

<p>The <code class="highlighter-rouge">network_edge.yml</code> and <code class="highlighter-rouge">network_edge_cleanup.yml</code> files contain playbooks for Network Edge mode.
Playbooks can be customized by enabling and configuring features in the <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code> file.</p>

<h3 id="cleanup-procedure">Cleanup procedure</h3>

<p>The cleanup procedure is used when a configuration error in the Edge Controller or Edge Nodes must be fixed. The script causes the appropriate installation to be reverted, so that the error can be fixed and <code class="highlighter-rouge">deploy.py</code> can be re-run. The cleanup procedure does not do a comprehensive cleanup (e.g., installation of DPDK or Golang will not be rolled back).</p>

<p>The cleanup procedure call a set of cleanup roles that revert the changes resulted from the cluster deployment. The changes are reverted by going step-by-step in the reverse order and undoing the steps.</p>

<p>For example, when installing Docker*, the RPM repository is added and Docker is installed. When cleaning up, Docker is uninstalled and the repository is removed.</p>

<p>To execute cleanup procedure</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>python3 deploy.py --clean
</code></pre>
</div>

<blockquote>
  <p><strong>NOTE</strong>: There may be leftovers created by the installed software. For example, DPDK and Golang installations, found in <code class="highlighter-rouge">/opt</code>, are not rolled back.</p>
</blockquote>

<h3 id="supported-epa-features">Supported EPA features</h3>

<p>Several enhanced platform capabilities and features are available in OpenNESS for Network Edge. For the full list of supported features, refer to Building Blocks / Enhanced Platform Awareness section. The documents referenced in this list provide a detailed description of the features, and step-by-step instructions for enabling them. Users should become familiar with available features before executing the deployment playbooks.</p>

<h3 id="vm-support-for-network-edge">VM support for Network Edge</h3>
<p>Support for VM deployment on OpenNESS for Network Edge is available and enabled by default. Certain configurations and prerequisites may need to be satisfied to use all VM capabilities. The user is advised to become familiar with the VM support documentation before executing the deployment playbooks. See <a href="../../applications-onboard/openness-network-edge-vm-support.md">openness-network-edge-vm-support</a> for more information.</p>

<h3 id="application-on-boarding">Application on-boarding</h3>

<p>Refer to the <a href="../../applications-onboard/network-edge-applications-onboarding.md">network-edge-applications-onboarding</a> document for instructions on how to deploy edge applications for OpenNESS Network Edge.</p>

<h3 id="single-node-network-edge-cluster">Single-node Network Edge cluster</h3>

<p>Network Edge can be deployed on just a single machine working as a control plane &amp; node.</p>

<p>To deploy Network Edge in a single-node cluster scenario, follow the steps below:</p>

<ol>
  <li>Modify <code class="highlighter-rouge">inventory.yml</code>
    <blockquote>
      <p>Rules for inventory:</p>
      <ul>
        <li>IP address (<code class="highlighter-rouge">ansible_host</code>) for both controller and node must be the same</li>
        <li><code class="highlighter-rouge">controller_group</code> and <code class="highlighter-rouge">edgenode_group</code> groups must contain exactly one host</li>
        <li><code class="highlighter-rouge">single_node_deployment</code> flag set to <code class="highlighter-rouge">true</code></li>
      </ul>
    </blockquote>

    <p>Example of a valid inventory:</p>

    <div class="language-yaml highlighter-rouge"><pre class="highlight"><code> <span class="s">---</span>
 <span class="s">all</span><span class="pi">:</span>
   <span class="s">vars</span><span class="pi">:</span>
     <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_central_office</span>
     <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_central_office</span>
     <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">true</span>   
     <span class="s">limit</span><span class="pi">:</span>  
 <span class="s">controller_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
     <span class="s">controller</span><span class="pi">:</span>
       <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
       <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
 <span class="s">edgenode_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
     <span class="s">node01</span><span class="pi">:</span>
       <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.234</span>
       <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
 <span class="s">edgenode_vca_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
 <span class="s">ptp_master</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
 <span class="s">ptp_slave_group</span><span class="pi">:</span>
   <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>Features can be enabled in the <code class="highlighter-rouge">inventory/default/group_vars/all/10-default.yml</code> file by tweaking the configuration variables.</p>
  </li>
  <li>
    <p>Settings regarding the kernel, grub, HugePages*, and tuned can be customized in <code class="highlighter-rouge">inventory/default/group_vars/edgenode_group/10-default.yml</code>.</p>

    <blockquote>
      <p><strong>NOTE</strong>: Default settings in the single-node cluster mode are those of the Edge Node (i.e., kernel and tuned customization enabled).</p>
    </blockquote>
  </li>
  <li>Single-node cluster can be deployed by running command:
    <div class="language-shell highlighter-rouge"><pre class="highlight"><code> <span class="nv">$ </span>python3 deploy.py
</code></pre>
    </div>
  </li>
</ol>

<h2 id="kubernetes-cluster-networking-plugins-network-edge">Kubernetes cluster networking plugins (Network Edge)</h2>

<p>Kubernetes uses 3rd party networking plugins to provide <a href="https://kubernetes.io/docs/concepts/cluster-administration/networking/">cluster networking</a>.
These plugins are based on the <a href="https://github.com/containernetworking/cni">CNI (Container Network Interface) specification</a>.</p>

<p>Converged Edge Experience Kits provide several ready-to-use Ansible roles deploying CNIs.
The following CNIs are currently supported:</p>

<ul>
  <li><a href="https://github.com/alauda/kube-ovn">kube-ovn</a>
    <ul>
      <li><strong>Only as primary CNI</strong></li>
      <li>CIDR: 10.16.0.0/16</li>
    </ul>
  </li>
  <li><a href="https://github.com/projectcalico/cni-plugin">calico</a>
    <ul>
      <li><strong>Only as primary CNI</strong></li>
      <li>IPAM: host-local</li>
      <li>CIDR: 10.245.0.0/16</li>
      <li>Network attachment definition: openness-calico</li>
    </ul>
  </li>
  <li><a href="https://github.com/coreos/flannel">flannel</a>
    <ul>
      <li>IPAM: host-local</li>
      <li>CIDR: 10.244.0.0/16</li>
      <li>Network attachment definition: openness-flannel</li>
    </ul>
  </li>
  <li><a href="https://github.com/weaveworks/weave">weavenet</a>
    <ul>
      <li>CIDR: 10.32.0.0/12</li>
    </ul>
  </li>
  <li><a href="https://github.com/intel/sriov-cni">SR-IOV</a> (cannot be used as a standalone or primary CNI - <a href="../../building-blocks/enhanced-platform-awareness/openness-sriov-multiple-interfaces.md">sriov setup</a>)</li>
  <li><a href="https://github.com/intel/userspace-cni-network-plugin">Userspace</a> (cannot be used as a standalone or primary CNI - <a href="../../building-blocks/dataplane/openness-userspace-cni.md">Userspace CNI setup</a></li>
</ul>

<p>Multiple CNIs can be requested to be set up for the cluster. To provide such functionality <a href="https://github.com/intel/multus-cni">the Multus CNI</a> is used.</p>

<blockquote>
  <p><strong>NOTE</strong>: For a guide on how to add new a CNI role to the Converged Edge Experience Kits, refer to <a href="../../getting-started/converged-edge-experience-kits.md#adding-new-cni-plugins-for-kubernetes-network-edge">the Converged Edge Experience Kits guide</a>.</p>
</blockquote>

<h3 id="selecting-cluster-networking-plugins-cni">Selecting cluster networking plugins (CNI)</h3>

<p>The default CNI for OpenNESS is calico. Non-default CNIs may be configured with OpenNESS by editing the file <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>.
To add a non-default CNI, the following edits must be carried out:</p>

<ul>
  <li>
    <p>The CNI name is added to the <code class="highlighter-rouge">kubernetes_cnis</code> variable. The CNIs are applied in the order in which they appear in the file. By default, <code class="highlighter-rouge">calico</code> is defined. That is,</p>

    <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubernetes_cnis</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">calico</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>To add a CNI, such as SR-IOV, the <code class="highlighter-rouge">kubernetes_cnis</code> variable is edited as follows:</p>

    <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kubernetes_cnis</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">calico</span>
<span class="pi">-</span> <span class="s">sriov</span>
</code></pre>
    </div>
  </li>
  <li>The Multus CNI is added by the Ansible playbook when two or more CNIs are defined in the <code class="highlighter-rouge">kubernetes_cnis</code> variable</li>
  <li>The CNI’s networks (CIDR for pods, and other CIDRs used by the CNI) are added to the <code class="highlighter-rouge">proxy_noproxy</code> variable by Ansible playbooks.</li>
</ul>

<h3 id="adding-additional-interfaces-to-pods">Adding additional interfaces to pods</h3>

<p>To add an additional interface from secondary CNIs, annotation is required.
Below is an example pod yaml file for a scenario with <code class="highlighter-rouge">kube-ovn</code> as a primary CNI along with <code class="highlighter-rouge">calico</code> and <code class="highlighter-rouge">flannel</code> as additional CNIs.
Multus* will create an interface named <code class="highlighter-rouge">calico</code> using the network attachment definition <code class="highlighter-rouge">openness-calico</code> and interface <code class="highlighter-rouge">flannel</code> using the network attachment definition <code class="highlighter-rouge">openness-flannel</code>.</p>
<blockquote>
  <p><strong>NOTE</strong>: Additional annotations such as <code class="highlighter-rouge">openness-calico@calico</code> are required only if the CNI is secondary. If the CNI is primary, the interface will be added automatically by Multus*.</p>
</blockquote>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">cni-test-pod</span>
  <span class="s">annotations</span><span class="pi">:</span>
    <span class="s">k8s.v1.cni.cncf.io/networks</span><span class="pi">:</span> <span class="s">openness-calico@calico, openness-flannel@flannel</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">cni-test-pod</span>
    <span class="s">image</span><span class="pi">:</span> <span class="s">docker.io/centos/tools:latest</span>
    <span class="s">command</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">/sbin/init</span>
</code></pre>
</div>

<p>The following is an example output of the <code class="highlighter-rouge">ip a</code> command run in a pod and after CNIs have been applied. Some lines in the command output were omitted for readability.</p>

<p>The following interfaces are available: <code class="highlighter-rouge">calico@if142</code>, <code class="highlighter-rouge">flannel@if143</code>, and <code class="highlighter-rouge">eth0@if141</code> (<code class="highlighter-rouge">kubeovn</code>).</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># kubectl exec -ti cni-test-pod ip a</span>

1: lo:
    inet 127.0.0.1/8 scope host lo

2: tunl0@NONE:
    link/ipip 0.0.0.0 brd 0.0.0.0

4: calico@if142:
    inet 10.243.0.3/32 scope global calico

6: flannel@if143:
    inet 10.244.0.3/16 scope global flannel

140: eth0@if141:
    inet 10.16.0.5/16 brd 10.16.255.255 scope global eth0
</code></pre>
</div>

<h1 id="qa">Q&amp;A</h1>

<h2 id="configuring-time">Configuring time</h2>

<p>To allow for correct certificate verification, OpenNESS requires system time to be synchronized among all nodes and controllers in a system.</p>

<p>OpenNESS provides the possibility to synchronize a machine’s time with the NTP server.
To enable NTP synchronization, change <code class="highlighter-rouge">ntp_enable</code> in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">ntp_enable</span><span class="pi">:</span> <span class="s">true</span>
</code></pre>
</div>

<p>Servers to be used instead of default ones can be provided using the <code class="highlighter-rouge">ntp_servers</code> variable in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">ntp_servers</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">ntp.local.server"</span><span class="pi">]</span>
</code></pre>
</div>

<h2 id="setup-static-hostname">Setup static hostname</h2>

<p>The following command is used in CentOS* to set a static hostname:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>hostnamectl <span class="nb">set</span>-hostname &lt;host_name&gt;
</code></pre>
</div>

<p>As shown in the following example, the hostname must also be defined in <code class="highlighter-rouge">/etc/hosts</code>:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4 &lt;host_name&gt;
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6 &lt;host_name&gt;
</code></pre>
</div>

<p>In addition to being a unique hostname within the cluster, the hostname must also follow Kubernetes naming conventions. For example, only lower-case alphanumeric characters “-“ or “.” start and end with an alphanumeric character. Refer to
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names">K8s naming restrictions</a> for additional details on these conventions.</p>

<h2 id="configuring-the-inventory-file">Configuring the Inventory file</h2>

<p>To execute playbooks, an inventory file <code class="highlighter-rouge">inventory.yml</code> must be defined in order to specify the target nodes on which the OpenNESS cluster(s) will be deployed.</p>

<p>The OpenNESS inventory contains three groups: <code class="highlighter-rouge">all</code>, <code class="highlighter-rouge">controller_group</code>, and <code class="highlighter-rouge">edgenode_group</code>.</p>

<ul>
  <li><code class="highlighter-rouge">all</code> contains all the variable definitions relevant to the cluster:
    <blockquote>
      <p><code class="highlighter-rouge">cluster_name</code>: defines the name of the OpenNESS edge cluster 
<code class="highlighter-rouge">flavor</code>: the deployment flavor to be deployed to the OpenNESS edge cluster
<code class="highlighter-rouge">single_node_deployment</code>: when set to <code class="highlighter-rouge">true</code>, mandates a single-node cluster deployment</p>
    </blockquote>
  </li>
  <li><code class="highlighter-rouge">controller_group</code> defines the node to be set up as the OpenNESS Edge Controller
    <blockquote>
      <p><strong>NOTE</strong>: Because only one controller is supported, the <code class="highlighter-rouge">controller_group</code> can contain only one host.</p>
    </blockquote>
  </li>
  <li><code class="highlighter-rouge">edgenode_group</code> defines the group of nodes that constitute the OpenNESS Edge Nodes.
    <blockquote>
      <p><strong>NOTE</strong>: All nodes will be joined to the OpenNESS Edge Controller defined in <code class="highlighter-rouge">controller_group</code>.</p>
    </blockquote>
  </li>
</ul>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="nn">---</span>
<span class="s">all</span><span class="pi">:</span>
  <span class="s">vars</span><span class="pi">:</span>
    <span class="s">cluster_name</span><span class="pi">:</span> <span class="s">5g_near_edge</span>
    <span class="s">flavor</span><span class="pi">:</span> <span class="s">cera_5g_near_edge</span>
    <span class="s">single_node_deployment</span><span class="pi">:</span> <span class="s">false</span>
    <span class="s">limit</span><span class="pi">:</span>
<span class="s">controller_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">ctrl.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.154</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
    <span class="s">node01.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.11</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
    <span class="s">node02.openness.org</span><span class="pi">:</span>
      <span class="s">ansible_host</span><span class="pi">:</span> <span class="s">10.102.227.79</span>
      <span class="s">ansible_user</span><span class="pi">:</span> <span class="s">openness</span>
<span class="s">edgenode_vca_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_master</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
<span class="s">ptp_slave_group</span><span class="pi">:</span>
  <span class="s">hosts</span><span class="pi">:</span>
</code></pre>
</div>

<p>In this example, a cluster named as <code class="highlighter-rouge">5g_near_edge</code> is deployed using the pre-defined deployment flavor <code class="highlighter-rouge">cera_5g_near_edge</code> that is composed of one controller node <code class="highlighter-rouge">ctrl.openness.org</code> and 2 edge nodes: <code class="highlighter-rouge">node01.openness.org</code> and <code class="highlighter-rouge">node02.openness.org</code>.</p>

<h2 id="exchanging-ssh-keys-between-hosts">Exchanging SSH keys between hosts</h2>

<p>Exchanging SSH keys between hosts permits a password-less SSH connection from the host running Ansible to the hosts being set up.</p>

<p>In the first step, the host running Ansible (usually the Edge Controller host) must have a generated SSH key. The SSH key can be generated by executing <code class="highlighter-rouge">ssh-keygen</code> and obtaining the key from the output of the command.</p>

<p>The following is an example of a key generation, in which the key is placed in the default directory (<code class="highlighter-rouge">/root/.ssh/id_rsa</code>), and an empty passphrase is used.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># ssh-keygen</span>

Generating public/private rsa key pair.
Enter file <span class="k">in </span>which to save the key <span class="o">(</span>/root/.ssh/id_rsa<span class="o">)</span>:  &lt;ENTER&gt;
Enter passphrase <span class="o">(</span>empty <span class="k">for </span>no passphrase<span class="o">)</span>:  &lt;ENTER&gt;
Enter same passphrase again:  &lt;ENTER&gt;
Your identification has been saved <span class="k">in</span> /root/.ssh/id_rsa.
Your public key has been saved <span class="k">in</span> /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:vlcKVU8Tj8nxdDXTW6AHdAgqaM/35s2doon76uYpNA0 root@host
The key<span class="s1">'s randomart image is:
+---[RSA 2048]----+
|          .oo.==*|
|     .   .  o=oB*|
|    o . .  ..o=.=|
|   . oE.  .  ... |
|      ooS.       |
|      ooo.  .    |
|     . ...oo     |
|      . .*o+.. . |
|       =O==.o.o  |
+----[SHA256]-----+
</span></code></pre>
</div>

<p>In the second step, the generated key must be copied to <strong>every host from the inventory</strong>, including the host on which the key was generated, if it appears in the inventory (e.g., if the playbooks are executed from the Edge Controller host, the host must also have a copy of its key). It is done by running <code class="highlighter-rouge">ssh-copy-id</code>. For example:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># ssh-copy-id root@host</span>

/usr/bin/ssh-copy-id: INFO: Source of key<span class="o">(</span>s<span class="o">)</span> to be installed: <span class="s2">"/root/.ssh/id_rsa.pub"</span>
The authenticity of host <span class="s1">'&lt;IP&gt; (&lt;IP&gt;)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:c7EroVdl44CaLH/IOCBu0K0/MHl8ME5ROMV0AGzs8mY.
ECDSA key fingerprint is MD5:38:c8:03:d6:5a:8e:f7:7d:bd:37:a0:f1:08:15:28:bb.
Are you sure you want to continue connecting (yes/no)? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@host'</span>s password:

Number of key<span class="o">(</span>s<span class="o">)</span> added: 1

Now, try logging into the machine, with:   <span class="s2">"ssh 'root@host'"</span>
and check to make sure that only the key<span class="o">(</span>s<span class="o">)</span> you wanted were added.
</code></pre>
</div>

<p>To make sure the key is copied successfully, try to SSH into the host: <code class="highlighter-rouge">ssh 'root@host'</code>. It should not ask for the password.</p>

<blockquote>
  <p><strong>NOTE</strong>: Where non-root user is used for example <code class="highlighter-rouge">openness</code> the command should be replaced to <code class="highlighter-rouge">ssh openness@host</code>. For more information about non-root user please refer to: 
<a href="../../building-blocks/enhanced-platform-awareness/openness-nonroot.md">The non-root user on the OpenNESS Platform</a></p>
  <h2 id="setting-proxy">Setting proxy</h2>
</blockquote>

<p>If a proxy is required to connect to the Internet, it is configured via the following steps:</p>

<ul>
  <li>Edit the <code class="highlighter-rouge">proxy_</code> variables in the <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code> file.</li>
  <li>Set the <code class="highlighter-rouge">proxy_enable</code> variable in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code> file to <code class="highlighter-rouge">true</code>.</li>
  <li>Append the network CIDR (e.g., <code class="highlighter-rouge">192.168.0.1/24</code>) to the <code class="highlighter-rouge">proxy_noproxy</code> variable in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>.</li>
</ul>

<p>Sample configuration of <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># Setup proxy on the machine - required if the Internet is accessible via proxy</span>
<span class="s">proxy_enable</span><span class="pi">:</span> <span class="s">true</span>
<span class="c1"># Clear previous proxy settings</span>
<span class="s">proxy_remove_old</span><span class="pi">:</span> <span class="s">true</span>
<span class="c1"># Proxy URLs to be used for HTTP, HTTPS and FTP</span>
<span class="s">proxy_http</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://proxy.example.org:3128"</span>
<span class="s">proxy_https</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://proxy.example.org:3129"</span>
<span class="s">proxy_ftp</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://proxy.example.org:3128"</span>
<span class="c1"># Proxy to be used by YUM (/etc/yum.conf)</span>
<span class="s">proxy_yum</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
<span class="c1"># No proxy setting contains addresses and networks that should not be accessed using proxy (e.g., local network and Kubernetes CNI networks)</span>
<span class="s">proxy_noproxy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
</code></pre>
</div>

<p>Sample definition of <code class="highlighter-rouge">no_proxy</code> environmental variable for Ansible host (to allow Ansible host to connect to other hosts):</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="nb">export </span><span class="nv">no_proxy</span><span class="o">=</span><span class="s2">"localhost,127.0.0.1,10.244.0.0/24,10.96.0.0/12,192.168.0.0/24"</span>
</code></pre>
</div>

<h2 id="obtaining-installation-files">Obtaining installation files</h2>

<p>There are no specific restrictions on the directory into which the OpenNESS directories are cloned. When OpenNESS is built, additional directories will be installed in <code class="highlighter-rouge">/opt</code>. It is recommended to clone the project into a directory such as <code class="highlighter-rouge">/home</code>.</p>

<h2 id="setting-git">Setting Git</h2>

<h3 id="github-token">GitHub token</h3>

<blockquote>
  <p><strong>NOTE</strong>: Only required when cloning private repositories. Not needed when using github.com/open-ness repositories.</p>
</blockquote>

<p>To clone private repositories, a GitHub token must be provided.</p>

<p>To generate a GitHub token, refer to <a href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">GitHub help - Creating a personal access token for the command line</a>.</p>

<p>To provide the token, edit the value of <code class="highlighter-rouge">git_repo_token</code> variable in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>.</p>

<h3 id="customize-tagbranchsha-to-checkout-on-edgeservices-repository">Customize tag/branch/sha to checkout on edgeservices repository</h3>

<p>A specific tag, branch, or commit SHA on edgeservices repository can be checked out by setting the <code class="highlighter-rouge">git_repo_branch</code> variable in <code class="highlighter-rouge">inventory/default/group_vars/all/10-open.yml</code>.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">git_repo_branch</span><span class="pi">:</span> <span class="s">master</span>
<span class="c1"># or</span>
<span class="s">git_repo_branch</span><span class="pi">:</span> <span class="s">openness-20.03</span>
</code></pre>
</div>

<h2 id="customization-of-kernel-grub-parameters-and-tuned-profile">Customization of kernel, grub parameters, and tuned profile</h2>

<p>Converged Edge Experience Kits provide an easy way to customize the kernel version, grub parameters, and tuned profile. For more information, refer to the <a href="../../getting-started/converged-edge-experience-kits.md">Converged Edge Experience Kits guide</a>.</p>


                        
                        <!--<div class="share uk-text-center uk-margin-medium-top">
    
        <a class="uk-link-muted" href="https://twitter.com/intent/tweet?text=Openness Cluster Setup&url=http://localhost:4000/docs/getting-started/openness-cluster-setup/&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter" onclick="window.open(this.href, 'twitter', 'width=550,height=235');return false;"><span data-uk-icon="icon: twitter; ratio: 1.2"></span></a>
    
    
        <a class="uk-link-muted uk-margin-small-left" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdocs%2Fgetting-started%2Fopenness-cluster-setup%2F" rel="nofollow" target="_blank" title="Share on Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><span data-uk-icon="icon: facebook; ratio: 1.2"></span></a>
    
</div>-->

                        
                    </div>

                    

                    <hr class="uk-margin-medium">

                    




                    <!--<div class="uk-margin-large-top">
    <h3>Related Docs</h3>

    
    
    

    <ul class="uk-list link-secondary">
    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    

    
    

    

    

    
    </ul>
</div>-->


                    
                </article>

                <script>
                    // Table of contents scroll to
                    UIkit.scroll('#markdown-toc a', {
                        duration: 400,
                        offset: 120
                    });
                </script>

            </div>
    </div>
</div>


    <div id="offcanvas-docs" data-uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar">

        <button class="uk-offcanvas-close" type="button" data-uk-close></button>

        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        
        <h5 class="uk-margin-top"></h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
        </ul>
        

    </div>
</div>


    <div id="offcanvas" data-uk-offcanvas="flip: true; overlay: true">
    <div class="uk-offcanvas-bar">

        <a class="uk-logo uk-margin-small-bottom" href="/intel-smart-edge-open/ido-specs/">Docs</a>
     
        <button class="uk-offcanvas-close" type="button" data-uk-close></button>
      
        <ul class="uk-nav uk-nav-primary uk-margin-top">
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/" >Home</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/docs/installation/" >Docs</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/blog/" >Blog</a></li>
                
            
                

                

                
                    <li><a href="/intel-smart-edge-open/ido-specs/changelog-timeline/" >Changelog</a></li>
                
            
                

                

                
                    <li><div class="uk-navbar-item"><a class="uk-button uk-button-success" href="/intel-smart-edge-open/ido-specs/contact/" >Contact</a></div></li>
                
            
        </ul>

        <div class="uk-margin-top uk-text-center">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                
<div class="uk-first-column">
    <a href="https://twitter.com/" data-uk-icon="icon: twitter" class="uk-icon-link uk-icon" target="_blank"></a>
</div>


<div>
    <a href="https://www.facebook.com/" data-uk-icon="icon: facebook" class="uk-icon-link uk-icon" target="_blank"></a>
</div>




<div>
    <a href="https://www.instagram.com/" data-uk-icon="icon: instagram" class="uk-icon-link uk-icon" target="_blank"></a>
</div>





<div>
    <a href="https://vimeo.com/" data-uk-icon="icon: vimeo" class="uk-icon-link uk-icon" target="_blank"></a>
</div>






            </div>
        </div>

    </div>
</div>


   <!--   -->

    
        
    

    

    </body>

</html>
